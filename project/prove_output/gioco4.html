<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Martian Grand Slam - Avventura Interattiva</title>
<style>
  body {
    background: #f9f9f9;
    color: #222;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  main {
    flex-grow: 1;
    max-width: 720px;
    margin: 2rem auto;
    padding: 1rem 2rem 3rem 2rem;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
  }
  h1, h2 {
    color: #004d99;
    margin-top: 0;
  }
  p {
    line-height: 1.5;
    font-size: 1.1rem;
  }
  .buttons {
    margin-top: 2rem;
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }
  button {
    background: #007acc;
    border: none;
    color: white;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 5px;
    cursor: pointer;
    flex-grow: 1;
    min-width: 140px;
    transition: background-color 0.3s ease;
  }
  button:hover, button:focus {
    background: #005f99;
    outline: none;
  }
  footer {
    text-align: center;
    padding: 1rem 0;
    font-size: 0.9rem;
    color: #666;
  }
</style>
</head>
<body>
<main id="game-container" role="main" aria-live="polite" aria-atomic="true">
  <!-- Content generated by JS -->
</main>
<footer>Martian Grand Slam &mdash; Avventura Interattiva Sci-Fi</footer>
<script>
(() => {
  "use strict";

  // Game state variables
  const state = {
    section: "start",
    // Track key flags for narrative consistency
    trainedInPhysics: false,
    equipmentUpgraded: false,
    reputationLevel: 0, // 0 none, 1 street matches, 2 minor rival defeated, 3 intensive training
    hasSponsor1: false,
    sponsor1RequiresProof: true,
    tournamentEntryPending: false,
    tournamentQualified: false,
    tournamentCompeting: false,
    tournamentAdvanced: false,
    finalMatchReady: false,
    evidenceCollected: false,
    riskOfSabotage: false,
    allianceFormed: false,
    moraleBoosted: false,
    champion: false,
    cheatingScandalResolved: false,
    vegaMovedToOlympus: false,
    vegaPresent: true,
  };

  // Narrative texts in Italian for each section
  const sections = {
    start: {
      title: "Martian Grand Slam",
      text: `Benvenuto a "Martian Grand Slam", un'avventura interattiva ambientata nella futuristica colonia di Olympus Station su Marte. Tu sei Nova Racket, un giovane prodigio del tennis terrestre, appena arrivato su Marte con il sogno di diventare il Campione Intergalattico di Tennis. Dovrai affrontare rivali locali, adattarti alla fisica marziana e scalare i tornei planetari fino alla sfida finale sulla luna di Giove, Europa. Riuscirai a superare gli ostacoli e a conquistare la gloria?`,
      choices: [
        { text: "Inizia il gioco", next: "section1" }
      ]
    },

    section1: {
      title: "Arrivo a Olympus Station",
      text: `Sei appena arrivato a Olympus Station, la stazione più avanzata per gli sport a gravità zero nel sistema solare. Il tuo equipaggiamento è obsoleto, non hai sponsor né classifica. Il campione marziano attuale è Vega Stratos, un avversario temuto. Le clique di rivali locali bloccano l'accesso ai tornei ufficiali e si vocifera che Vega usi tecnologie illegali per migliorare le sue prestazioni. Cosa vuoi fare per iniziare il tuo percorso?`,
      choices: [
        { text: "Cerca un allenatore locale per imparare la fisica marziana", next: "section2" },
        { text: "Visita il mercato di Olympus Station per aggiornare racchetta e tuta", next: "section3" },
        { text: "Partecipa a partite di strada non ufficiali per guadagnare reputazione", next: "section4" }
      ]
    },

    section2: {
      title: "Incontro con l'allenatore e allenamento",
      text: `Hai trovato un allenatore locale disposto a insegnarti le particolarità della fisica marziana. L'allenamento migliora notevolmente le tue abilità, ma non hai ancora uno sponsor né una classifica. I rivali ti guardano con sospetto, ma non sono ancora ostili. Ora puoi mettere alla prova le tue capacità o migliorare il tuo equipaggiamento.`,
      choices: [
        { text: "Sfida un rivale minore per dimostrare il tuo valore e accedere alle Olympus Trials", next: "section5" },
        { text: "Visita il mercato per acquistare racchetta e tuta high-tech", next: "section3" },
        { text: "Parla con gli sponsor per ottenere supporto dopo l'allenamento", next: "section6" }
      ]
    },

    section3: {
      title: "Aggiornamento equipaggiamento al mercato",
      text: `Al mercato di Olympus Station hai acquistato una racchetta e una tuta high-tech, perfettamente adattate alla bassa gravità marziana. Anche se i rivali ti guardano con diffidenza, il tuo nuovo equipaggiamento migliora la tua posizione. Ora puoi allenarti con un coach, tentare di entrare nel torneo Olympus Trials o cercare sponsor.`,
      choices: [
        { text: "Cerca un allenatore locale per adattarti al nuovo equipaggiamento", next: "section2" },
        { text: "Prova a entrare nel torneo Olympus Trials con il nuovo equipaggiamento", next: "section7" },
        { text: "Avvicina gli sponsor per ottenere supporto citando il nuovo equipaggiamento", next: "section6" }
      ]
    },

    section4: {
      title: "Partite di strada non ufficiali",
      text: `Hai iniziato a giocare partite di strada non ufficiali, guadagnando un po' di reputazione e qualche punto in classifica minore. Il tuo equipaggiamento è ancora obsoleto e i rivali ti osservano con ostilità. Puoi ora migliorare le tue abilità con un allenatore, aggiornare l'equipaggiamento o tentare di entrare nel torneo Olympus Trials.`,
      choices: [
        { text: "Cerca un allenatore per migliorare ulteriormente le tue abilità", next: "section2" },
        { text: "Visita il mercato per aggiornare l'equipaggiamento", next: "section3" },
        { text: "Prova a entrare nel torneo Olympus Trials usando la reputazione guadagnata", next: "section7" }
      ]
    },

    section5: {
      title: "Sfida e vittoria contro un rivale minore",
      text: `Hai sfidato un rivale minore e l'hai sconfitto, guadagnando l'accesso al torneo Olympus Trials. La tua reputazione cresce tra i rivali, anche se il tuo equipaggiamento è ancora basico o obsoleto. Ora puoi migliorare il tuo equipaggiamento o allenarti intensamente per il torneo.`,
      choices: [
        { text: "Visita il mercato per aggiornare racchetta e tuta prima del torneo", next: "section3" },
        { text: "Allenati intensamente con il coach per prepararti alle Olympus Trials", next: "section8" }
      ]
    },

    section6: {
      title: "Incontro con gli sponsor",
      text: `Hai parlato con uno sponsor interessato, ma richiede una prova concreta delle tue abilità. Devi ancora qualificarti per le Olympus Trials. A seconda delle tue scelte precedenti, il tuo equipaggiamento potrebbe essere aggiornato o meno. Puoi usare il supporto dello sponsor per entrare in tornei minori, allenarti o raccogliere prove del presunto cheating di Vega.`,
      choices: [
        { text: "Usa il supporto dello sponsor per partecipare a tornei minori", next: "section4" },
        { text: "Allenati o sfida rivali per dimostrare le tue abilità", next: "section2" },
        { text: "Cerca di raccogliere prove del cheating di Vega", next: "section9" }
      ]
    },

    section7: {
      title: "Tentativo di entrare alle Olympus Trials",
      text: `Stai tentando di entrare nel torneo Olympus Trials. Le clique rivali mettono in dubbio la tua ammissione, mettendo alla prova il tuo equipaggiamento e la tua reputazione. L'ingresso al torneo è in sospeso e devi decidere come procedere.`,
      choices: [
        { text: "Vinci una partita di qualificazione contro un rivale", next: "section8" },
        { text: "Negozia con i leader delle clique per ottenere l'accesso", next: "section10" }
      ]
    },

    section8: {
      title: "Inizio del torneo Olympus Trials",
      text: `Sei qualificato e stai competendo nelle Olympus Trials. I rivali e i sostenitori di Vega sono presenti, e il tuo equipaggiamento può essere aggiornato o basico a seconda del percorso scelto. Ora devi vincere le partite per avanzare verso la finale o investigare sui rumor riguardanti il cheating di Vega.`,
      choices: [
        { text: "Vinci le partite per avanzare verso la finale", next: "section11" },
        { text: "Indaga sui rumor del cheating di Vega durante il torneo", next: "section9" }
      ]
    },

    section9: {
      title: "Indagine sul cheating di Vega",
      text: `Hai iniziato a raccogliere indizi e prove sul presunto uso di tecnologie illegali da parte di Vega. C'è il rischio di essere scoperto o sabotato dai rivali. Puoi decidere di affrontare Vega direttamente, consegnare le prove agli ufficiali ITL o concentrarti sulle partite per costruire una reputazione inconfutabile.`,
      choices: [
        { text: "Affronta Vega con le prove raccolte", next: "section12" },
        { text: "Consegna le prove agli ufficiali ITL per un'indagine", next: "section13" },
        { text: "Concentrati sulle partite per costruire una reputazione inconfutabile", next: "section11" }
      ]
    },

    section10: {
      title: "Negoziazione con le clique rivali",
      text: `Le clique rivali sono scettiche ma considerano un accordo. Devi dimostrare il tuo valore o offrire un'alleanza rischiosa. La fiducia è fragile e le rivalità non sono completamente superate.`,
      choices: [
        { text: "Accetta un'alleanza rischiosa con un leader di clique", next: "section14" },
        { text: "Rifiuta e tenta la partita di qualificazione", next: "section8" }
      ]
    },

    section11: {
      title: "Avanzamento nel torneo Olympus Trials",
      text: `Hai vinto partite chiave, aumentando la tua classifica e ottenendo uno o due sponsor. Vega si sta preparando per lo scontro finale. Ora puoi prepararti per la partita finale o continuare a investigare sul cheating di Vega.`,
      choices: [
        { text: "Preparati per la partita finale contro Vega", next: "section15" },
        { text: "Continua a investigare sul cheating di Vega", next: "section9" }
      ]
    },

    section12: {
      title: "Confronto con Vega",
      text: `Hai affrontato Vega con le prove raccolte. Vega nega ogni accusa e la tensione sale. Le clique rivali e gli ufficiali osservano attentamente. Puoi sfidare Vega in una partita ufficiale a gravità zero per dimostrare il tuo valore o presentare le prove agli ufficiali ITL.`,
      choices: [
        { text: "Sfida Vega in una partita ufficiale a gravità zero", next: "section15" },
        { text: "Presenta le prove agli ufficiali ITL per un'indagine", next: "section13" }
      ]
    },

    section13: {
      title: "Presentazione delle prove agli ufficiali ITL",
      text: `Gli ufficiali ITL aprono un'indagine su Vega, che viene temporaneamente sospeso in attesa dei risultati. La finale delle Olympus Trials viene posticipata. Puoi allenarti e prepararti per la finale rinviata o usare il tempo per assicurarti l'ultimo sponsor.`,
      choices: [
        { text: "Allenati e preparati per la finale rinviata", next: "section15" },
        { text: "Usa il tempo per assicurarti l'ultimo sponsor", next: "section16" }
      ]
    },

    section14: {
      title: "Alleanza con un leader di clique",
      text: `Hai formato un'alleanza con un leader di una clique rivale. Ora hai accesso limitato ai tornei, le rivalità si attenuano ma la fiducia è fragile. Il tuo equipaggiamento e l'allenamento migliorano grazie ai nuovi contatti.`,
      choices: [
        { text: "Partecipa alle Olympus Trials con il supporto della clique", next: "section8" },
        { text: "Cerca di raccogliere prove su Vega usando i nuovi contatti", next: "section9" }
      ]
    },

    section15: {
      title: "Partita finale a gravità zero contro Vega su Europa",
      text: `Sei nella Grand Arena su Europa, pronto a sfidare Vega Stratos nella partita finale del Campionato Intergalattico di Tennis. Entrambi siete equipaggiati con il meglio della tecnologia. L'atmosfera è carica di tensione e ogni punto conta. Come vuoi giocare?`,
      choices: [
        { text: "Gioca aggressivamente per vincere il campionato", next: "section17" },
        { text: "Usa una strategia focalizzata sulle debolezze di Vega", next: "section17" }
      ]
    },

    section16: {
      title: "Assicurazione dell'ultimo sponsor",
      text: `Hai ottenuto l'ultimo sponsor, aumentando il morale e le risorse a tua disposizione. Ora sei completamente supportato e pronto per la partita finale.`,
      choices: [
        { text: "Allenati intensamente per la partita finale", next: "section15" }
      ]
    },

    section17: {
      title: "Vittoria al Campionato Intergalattico di Tennis",
      text: `Con una prestazione straordinaria, hai sconfitto Vega Stratos e sei stato incoronato Campione Intergalattico di Tennis. Lo scandalo del cheating è stato risolto, e sponsor e fan celebrano la tua vittoria. Il futuro è luminoso e pieno di nuove sfide. Complimenti, Nova!`,
      choices: [
        { text: "Festeggia la vittoria e pianifica i prossimi passi", next: "end" }
      ]
    },

    end: {
      title: "Fine dell'avventura",
      text: `Grazie per aver giocato a "Martian Grand Slam". Vuoi provare di nuovo e vivere un percorso diverso?`,
      choices: [
        { text: "Gioca di nuovo", next: "start" }
      ]
    }
  };

  // Helper to update state flags based on section transitions
  function updateStateForSection(section) {
    switch(section) {
      case "section2":
        state.trainedInPhysics = true;
        state.reputationLevel = Math.max(state.reputationLevel, 1);
        state.rivalrySuspicious = true;
        state.rivalryHostile = false;
        break;
      case "section3":
        state.equipmentUpgraded = true;
        state.reputationLevel = Math.max(state.reputationLevel, 1);
        state.rivalryHostile = true;
        break;
      case "section4":
        state.reputationLevel = Math.max(state.reputationLevel, 1);
        state.rivalryHostile = true;
        break;
      case "section5":
        state.tournamentQualified = true;
        state.reputationLevel = Math.max(state.reputationLevel, 2);
        break;
      case "section6":
        if (state.sponsor1RequiresProof && !state.hasSponsor1) {
          // Sponsor interested but requires proof
        }
        break;
      case "section7":
        state.tournamentEntryPending = true;
        break;
      case "section8":
        if (state.tournamentQualified) {
          state.tournamentCompeting = true;
          state.tournamentEntryPending = false;
        }
        break;
      case "section9":
        state.evidenceCollected = true;
        state.riskOfSabotage = true;
        break;
      case "section10":
        // Negotiation in progress
        break;
      case "section11":
        state.reputationLevel = Math.max(state.reputationLevel, 3);
        if (!state.hasSponsor1) {
          state.hasSponsor1 = true; // gained sponsors during tournament
          state.sponsor1RequiresProof = false;
        }
        break;
      case "section12":
        // confrontation
        break;
      case "section13":
        state.cheatingScandalResolved = true;
        state.vegaMovedToOlympus = false;
        break;
      case "section14":
        state.allianceFormed = true;
        state.rivalryHostile = false;
        state.rivalrySuspicious = true;
        break;
      case "section15":
        state.finalMatchReady = true;
        break;
      case "section16":
        state.hasSponsor1 = true;
        state.moraleBoosted = true;
        break;
      case "section17":
        state.champion = true;
        state.cheatingScandalResolved = true;
        break;
      case "section1":
        // Reset initial flags for new game start
        state.trainedInPhysics = false;
        state.equipmentUpgraded = false;
        state.reputationLevel = 0;
        state.hasSponsor1 = false;
        state.sponsor1RequiresProof = true;
        state.tournamentEntryPending = false;
        state.tournamentQualified = false;
        state.tournamentCompeting = false;
        state.tournamentAdvanced = false;
        state.finalMatchReady = false;
        state.evidenceCollected = false;
        state.riskOfSabotage = false;
        state.allianceFormed = false;
        state.moraleBoosted = false;
        state.champion = false;
        state.cheatingScandalResolved = false;
        state.vegaMovedToOlympus = false;
        state.vegaPresent = true;
        break;
      case "end":
        // no state changes
        break;
    }
  }

  // Render function
  function renderSection(sectionKey) {
    const container = document.getElementById("game-container");
    const section = sections[sectionKey];
    if (!section) return;

    // Update state for this section
    updateStateForSection(sectionKey);
    state.section = sectionKey;

    // Clear container
    container.innerHTML = "";

    // Title
    const h1 = document.createElement("h1");
    h1.textContent = section.title;
    container.appendChild(h1);

    // Narrative text
    const p = document.createElement("p");
    p.textContent = section.text;
    container.appendChild(p);

    // Buttons container
    const buttonsDiv = document.createElement("div");
    buttonsDiv.className = "buttons";

    // Create buttons for choices
    section.choices.forEach(choice => {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.textContent = choice.text;
      btn.addEventListener("click", () => {
        // Special logic for some transitions based on plan steps and state
        handleSpecialTransitions(choice.next);
      });
      buttonsDiv.appendChild(btn);
    });

    container.appendChild(buttonsDiv);
  }

  // Handle special transitions to reflect the plan steps and state changes
  function handleSpecialTransitions(nextSection) {
    // Implement the plan steps and state-dependent logic

    // According to plan steps:
    // 1) (move vega arena-loc olympus-station)
    // 2) (secure-final-sponsor nova sponsor1 olympus-station)
    // 3) (seek-coach nova olympus-station)
    // 4) (challenge-minor-rival nova vega olympus-station)
    // 5) (advance-tournament nova)
    // 6) (prepare-final-match nova olympus-station)
    // 7) (win-final-match nova vega olympus-station)

    // We simulate these steps in the narrative flow.

    // Move Vega to Olympus Station (triggered early)
    if (!state.vegaMovedToOlympus && (nextSection === "section6" || nextSection === "section2" || nextSection === "section5")) {
      state.vegaMovedToOlympus = true;
      state.vegaPresent = true;
    }

    // Secure final sponsor (step 2)
    if (!state.hasSponsor1 && nextSection === "section6") {
      state.hasSponsor1 = true;
      state.sponsor1RequiresProof = false;
    }

    // Challenge minor rival (step 4)
    if (nextSection === "section5") {
      state.tournamentQualified = true;
      state.reputationLevel = Math.max(state.reputationLevel, 2);
    }

    // Advance tournament (step 5)
    if (nextSection === "section11") {
      state.tournamentAdvanced = true;
      state.tournamentCompeting = true;
      state.tournamentQualified = false;
      state.reputationLevel = Math.max(state.reputationLevel, 3);
      if (!state.hasSponsor1) {
        state.hasSponsor1 = true;
        state.sponsor1RequiresProof = false;
      }
    }

    // Prepare final match (step 6)
    if (nextSection === "section15") {
      state.finalMatchReady = true;
    }

    // Win final match (step 7)
    if (nextSection === "section17") {
      state.champion = true;
      state.cheatingScandalResolved = true;
      state.tournamentCompeting = false;
    }

    // Render the next section
    renderSection(nextSection);
  }

  // Initialize game
  function initGame() {
    renderSection("start");
  }

  // Start game on page load
  window.addEventListener("load", initGame);
})();
</script>
</body>
</html>